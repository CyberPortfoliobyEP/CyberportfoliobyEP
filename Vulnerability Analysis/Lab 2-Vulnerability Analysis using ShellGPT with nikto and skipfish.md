# Lab: Vulnerability Assessment using SGPT and AI-Powered Tools

## Lab Details

- **Title:** Vulnerability Assessment using Nikto and Skipfish
- **Target Systems:** Simulated vulnerable websites
  - **Target URL 1:** www.certifiedhacker.com
  - **Target URL 2:** testphp.vulnweb.com
- **Attacker Machine:** Parrot Security OS with integrated SGPT API
- **Tools:**
  - SGPT
  - Nikto
  - Skipfish
  - Firefox Browser

---

## Lab Scenario

In this lab, I used SGPT to initiate vulnerability scans on two target websites. The tools Nikto and Skipfish were utilized to identify potential security gaps. The goal was to analyze the reports, interpret the findings, and document the results.

---

## Step 1: Vulnerability Analysis with Nikto on www.certifiedhacker.com

### Command Execution

In the terminal, I used the following SGPT command to initiate the scan:  
```bash
sgpt --shell "perform a vulnerability scan on the target url www.certifiedhacker.com"
`
This led SGPT to generate the following command for Nikto:  
```bash
nikto -h www.certifiedhacker.com
```

Nikto executed the scan and examined the target website for configuration and security issues.

[img](https://i.imgur.com/mTXV1DZ.png)

### Results

- Missing X-Frame-Options: Allows clickjacking attacks.
- Missing X-Content-Type-Options: Could lead to MIME-type attacks.
- Unusual Host Header: Displays Base64-encoded values.
- Error threshold reached: The scan was prematurely terminated, but some vulnerabilities were detected.

### Interpretation

- Fundamental security issues in header configurations, allowing clickjacking and MIME manipulation.
- Similar MIME-type vulnerabilities as identified in Skipfish during Step 2.
- The unusual Host Header may indicate potential misconfigurations.

---

## Step 2: Vulnerability Analysis with Skipfish on testphp.vulnweb.com

### Command Execution

In the terminal, I ran the following SGPT command to initiate the scan:  

```bash
sgpt --chat vuln --shell "Perform a vulnerability scan for URL http://testphp.vulnweb.com with skipfish -o ~/skipfish_output http://testphp.vulnweb.com"
```
[img](https://i.imgur.com/GFTm41h.png)

Skipfish performed the scan and saved the results in the folder `~/skipfish_output`. This folder contained multiple files, including a detailed report named `index.html`. 
[img](https://i.imgur.com/pGgMz2y.png)

I opened this report using the following command:  
```bash
firefox ~/skipfish_output/index.html
```
[img](https://i.imgur.com/LBG0dn6.png)
[img](https://i.imgur.com/WclR8T9.png)

### Results

- Report details revealed multiple vulnerabilities, including:
  - High risks:
    - Signature match errors
    - MIME type and charset conflicts
  - Medium risks:
    - HTML forms lacking XSRF protection
    - Embedded external content
  - Low risks:
    - Incorrect or missing MIME types
    - Missing or incorrect charsets
    - Directory listing enabled


### Interpretation

- Multiple security issues, especially with MIME type and charset configurations.
- Lack of XSRF protection in forms.
- Similarities to Nikto: MIME-type vulnerabilities were also found in Step 1.
- Generated report files provide a clear structure to identify and address vulnerabilities.

---

## Summary

### Actions Taken:
- Used SGPT to initiate vulnerability scans with Nikto and Skipfish.
- Analyzed the target websites www.certifiedhacker.com and testphp.vulnweb.com.
- Documented and interpreted the results of the scans.

### Key Findings:
- **www.certifiedhacker.com:**
  - Header configuration issues (X-Frame-Options, X-Content-Type-Options).
  - MIME-type vulnerabilities similar to those found in Skipfish.
- **testphp.vulnweb.com:**
  - Issues with MIME types, charsets, and forms.
  - Lack of XSRF protection and poorly secured directories.

### Recommendations:
- Implement security headers like X-Frame-Options and X-Content-Type-Options on www.certifiedhacker.com.
- Fix MIME type and charset configurations on both websites.
- Review and secure HTML forms, particularly by adding XSRF protection.
- Regularly use tools like Skipfish and Nikto for proactive vulnerability identification and remediation.