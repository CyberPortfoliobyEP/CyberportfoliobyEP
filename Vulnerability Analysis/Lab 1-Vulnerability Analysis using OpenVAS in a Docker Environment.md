# Lab: Vulnerability Assessment using OpenVAS in a Docker Environment

## Lab Details

- **Title:** Conducting a Vulnerability Analysis with OpenVAS
- **Target System:** Windows Server 2022 with an enabled and disabled firewall
  - **IP Address:** 10.10.1.22
- **Attacker Machine:** Parrot Security OS
  - **IP Address:** 10.10.1.13
- **Tools:** 
  - Docker
  - OpenVAS/Greenbone Vulnerability Management
  - Firefox Browser

---

## Lab Scenario

This lab involves conducting a vulnerability assessment as part of a penetration test to uncover potential security gaps in a target machine (Windows Server 2022). The target system is scanned twice, first with its firewall enabled and then with the firewall disabled. The objective is to determine how well the existing security measures protect against potential attacks and to identify vulnerabilities that could be exploited.

---

## Steps in Conducting the Vulnerability Assessment

### Step 1: Preparing the Attacker Machine

To begin, I prepared the Parrot Security OS machine by ensuring it was fully updated and equipped with the necessary tools. Using Docker, I downloaded the OpenVAS container image and ran it to provide the scanning environment.

The following commands were used:
- Updating the system: ```bash sudo apt upgrade```
- Pulling the OpenVAS Docker image: `docker pull mikesplain/openvas`
- Running the container: `docker run -d -p 443:443 --name openvas mikesplain/openvas`

After completing this, the container was successfully deployed and ready to use for vulnerability scanning.

![Deployment Screenshot](https://i.imgur.com/LtoyBFW.png)

---

### Step 2: Accessing the OpenVAS Dashboard

Once the OpenVAS container was running, I accessed its dashboard through Firefox. Navigating to `https://127.0.0.1`, I logged in using the default credentials (`admin/admin`), which allowed me to interact with the OpenVAS interface.

![img](https://i.imgur.com/PWF1KMh.png)
![img](https://i.imgur.com/YOc9kOm.png)
---

### Step 3: Conducting the First Scan (Firewall Enabled)

With the target system's firewall enabled, I initiated the first vulnerability scan. Using the OpenVAS dashboard, I created a new scan task:
- Task Name: Immediate Scan
- Target IP Address: `10.10.1.22`

1. The scan identified **60 potential findings** on the target IP 10.10.1.22 using the *Full and fast* configuration.

2. The scan was successfully completed (*Status: Done*) in **13 minutes and 7 seconds**, with no overrides or custom notes.

3. The results are **neutral**, as this screen only shows the number of findings without details on their type or severity. A detailed assessment requires analyzing the full report.

![img](https://i.imgur.com/WgJFKo4.png)

![img](https://i.imgur.com/mDMaXyi.png)
---

### Step 4: Disabling the Firewall

After analyzing the results of the first scan, I switched to the target machine and disabled its firewall to assess its impact on the vulnerabilities identified. This was done through the following steps:
1. Navigating to the Control Panel on Windows Server 2022.
2. Accessing System and Security > Windows Defender Firewall.
3. Turning off all firewall settings.

![img](https://i.imgur.com/O9tFtEG.png)

---

### Step 5: Conducting the Second Scan (Firewall Disabled)

Returning to the Parrot Security OS machine, I repeated the scan with the same settings. The objective was to compare results and identify any additional vulnerabilities that might surface with the firewall disabled.

Key observations from this scan include:
- **Total Vulnerabilities Identified:** 60 (same as the first scan)
- **Key Vulnerabilities:**
  - DCE/RPC and MSRPC Services Enumeration Reporting
    - **Severity:** Medium (5.0)
  - TCP Timestamps
    - **Severity:** Low (2.6)

These findings confirm that disabling the firewall did not result in the discovery of new vulnerabilities but highlighted the same issues as before. Screenshot 9 documents these results.

![img](https://i.imgur.com/T8Vcf7w.png)

---

## Summary

### Actions Taken:
- Prepared the Parrot Security OS machine and deployed the OpenVAS Docker container.
- Accessed the OpenVAS dashboard and conducted two vulnerability scans with the target system's firewall enabled and disabled.

### Key Findings:
- The target system leaks information about its services even with the firewall enabled.
- Vulnerabilities such as DCE/RPC expose critical configuration details, which attackers can exploit for further attacks.
- The TCP Timestamps vulnerability could allow timing attacks, though its severity is relatively low.

### Recommendations:
- Disable or restrict DCE/RPC services on the target system to prevent information leakage.
- Implement timestamp masking to obscure TCP timestamps.
- Review and harden firewall rules to minimize information exposure about open ports.
