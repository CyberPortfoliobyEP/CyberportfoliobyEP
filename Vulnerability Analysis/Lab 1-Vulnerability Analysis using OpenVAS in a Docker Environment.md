# Lab: Vulnerability Assessment using OpenVAS in a Docker Environment

## Lab-Details

- **Titel:** Durchführung einer Schwachstellenanalyse mit OpenVAS
- **Zielsystem:** Windows Server 2022 mit aktivierter und deaktivierter Firewall
  - **IP-Adresse:** 10.10.1.22
- **Angreifer-Maschine:** Parrot Security OS
  - **IP-Adresse:** 10.10.1.13
- **Tools:** 
  - Docker
  - OpenVAS/Greenbone Vulnerability Management
  - Firefox-Browser

---

## Lab-Szenario

Im Rahmen eines Penetrationstests soll eine Schwachstellenanalyse durchgeführt werden, um potenzielle Sicherheitslücken in einer Zielmaschine (Windows Server 2022) aufzudecken. Dabei wird die Zielmaschine einmal mit aktivierter und einmal mit deaktivierter Firewall gescannt. Ziel des Tests ist es, herauszufinden, wie effektiv die vorhandenen Sicherheitsmaßnahmen gegen Angriffe geschützt sind und welche Schwachstellen ausgenutzt werden können.

---

## Schritte zur Durchführung der Schwachstellenanalyse

### Schritt 1: Vorbereitung der Angreifer-Maschine

1. Aktualisieren Sie die Parrot Security OS-Maschine mit folgendem Befehl:

  sudo apt upgrade


2. Führen Sie den Docker-Befehl aus, um das OpenVAS-Image herunterzuladen:
```bash 
    docker pull mikesplain/openvas
```

4. Starten Sie den OpenVAS-Container mit folgendem Befehl:
```bash 
   docker run -d -p 443:443 --name openvas mikesplain/openvas
```
![img](https://i.imgur.com/LtoyBFW.png)

---

### Schritt 2: Zugriff auf das OpenVAS-Dashboard

1. Öffnen Sie Firefox und navigieren Sie zur URL:
  **https://127.0.0.1**

2. Melden Sie sich mit den Standard-Credentials admin/admin an.

![img](https://i.imgur.com/PWF1KMh.png) 

![img](https://i.imgur.com/YOc9kOm.png)

---

### Schritt 3: Durchführung des ersten Scans (Firewall aktiv)

1. Navigieren Sie im OpenVAS-Dashboard zu:
   - Scans > Tasks
   - Wählen Sie den Task Wizard und geben Sie die Ziel-IP-Adresse **10.10.1.22** ein.
   - Starten Sie den Scan.

![img](https://i.imgur.com/WgJFKo4.png)

![img](https://i.imgur.com/8xTrJ2T.png)

2. Ergebnisse:
   - Keine spezifischen schwachstellen entdeckt:
     - **Schweregrad:** 5.0 (Medium)
     - **Beschreibung:** Der OpenVAS-Scan der Ziel-IP 10.10.1.22 identifizierte eine Schwachstelle mit mittlerem Schweregrad (5.0 Medium) und keine hoch- oder kritisch bewerteten Schwachstellen.
   - Durchschnittliche Scan-Dauer: **13 Minuten und 7 Sekunden**  
   - **Screenshot 7**

---

### Schritt 4: Deaktivierung der Firewall

1. Wechseln Sie auf die Zielmaschine (Windows Server 2022).
2. Deaktivieren Sie die Firewall:
   - Control Panel > System and Security > Windows Defender Firewall
   - Setzen Sie alle Optionen auf Off.

   **Screenshot 8**

---

### Schritt 5: Durchführung des zweiten Scans (Firewall deaktiviert)

1. Kehren Sie zur Parrot Security OS-Maschine zurück.
2. Wiederholen Sie den Scan mit denselben Einstellungen wie zuvor.

   **Screenshot 9**

3. Ergebnisse:
   - Es wurden erneut **60 Schwachstellen** entdeckt. Die wichtigsten Schwachstellen umfassen:
     - **DCE/RPC and MSRPC Services Enumeration Reporting (Schweregrad: 5.0, Medium)**
     - **TCP Timestamps (Schweregrad: 2.6, Low)**

---

## Zusammenfassung

### Durchgeführte Schritte:
- Vorbereitung der Parrot Security OS-Maschine und des Docker-Containers.
- Initialisierung und Zugriff auf das OpenVAS-Dashboard.
- Durchführung von Schwachstellenscans mit aktivierter und deaktivierter Firewall.

### Erkenntnisse:
- Die Zielmaschine gibt trotz aktivierter Firewall Informationen über ihre Dienste preis.
- Schwachstellen wie DCE/RPC können Angreifern wichtige Informationen liefern.

### Empfehlungen:
- Deaktivieren oder beschränken Sie DCE/RPC-Dienste auf dem Zielsystem.
- Implementieren Sie Zeitstempel-Maskierung, um TCP-Timestamps zu verbergen.
- Überprüfen und härten Sie die Firewall-Regeln, um Informationen über offene Ports zu minimieren.
