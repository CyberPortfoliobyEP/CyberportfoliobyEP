# **Lab Report: Detection and Response to Phishing Emails**

---

## **Lab Details**

- **Lab Name**: Detection and Response to Phishing Emails  
- **Lab Environment**: Windows 11, Parrot Security OS  
- **Objective**: Analyze and mitigate a simulated phishing attack using VirusTotal, NetCraft, and Microsoft Defender Firewall.  
- **Tools Used**: Perplexity, Temp-Mail, Anonymousemail.me, VirusTotal, NetCraft, Microsoft Defender.  
- **Attacker Fake Identity**: John Lab (Windows Administrator)  
- **Victim Fake Identity**: Sam  

---

## **Introduction**

Phishing attacks are one of the most common and effective forms of cyberattacks. They use deceptive emails to trick users into opening malicious links or providing sensitive information. The goal of this lab is to simulate such a threat, analyze it, and implement appropriate defense mechanisms.

---

## **Techniques and Results**

---

### **1. Creation and Sending of a Phishing Email**

#### **Steps:**
1. **Creating the Phishing Email**:
   - The platform **Perplexity** was used to generate the following email text:
     > _"Create an e-mail from John to Sam. John is a Windows Server Administrator and wants Sam to know that his Windows 2022 Server needs immediately an update because of malicious activity. Write the mail in a realistic and professional way and set a link of the update there but leave the blank."_
   - The generated text was copied and used for the phishing email.  
   - ![Perplexity Screenshot](perplexity.png)

2. **Sending the Email**:
   - The platform **Anonymousemail.me** was used as the sender service.
   - The following sender address was used: `John.Lab@microsoftft.com`.  
   - The recipient address was generated using a **temporary email service**: `https://temp-mail.org/de` with the address `Febawil496@mowline.com`.  
   - The Perplexity-generated text was included in the email, and the malicious link `https://end-authenticat.tftpd.net/` was embedded.  
   - ![Sender Email Screenshot](Absender%20Mail.png)  
   - ![Embedded Link Screenshot](Link%20eingebedded.png)

#### **Results:**
The email was successfully sent using Anonymousemail.me and received by the temporary email service. The malicious link was embedded in the text and ready for analysis.

#### **Interpretation:**  
This simulation demonstrates how easily convincing phishing emails can be created and sent, highlighting the need for effective security measures.

---

### **2. Checking the Link with NetCraft**

#### **Steps:**
1. **Installing the NetCraft Extension**:
   - The **NetCraft extension** was added to the Firefox browser:
     - Navigated to the official NetCraft website ([https://www.netcraft.com/](https://www.netcraft.com/)).
     - The extension was installed and activated.

2. **Opening the Email**:
   - The received phishing email was opened on **Temp-Mail.org**.
   - The embedded malicious link `https://end-authenticat.tftpd.net/` was successfully identified and blocked by **NetCraft**.  
   - ![NetCraft Block Screenshot](net.jpg)

3. **Copying the Link**:
   - The URL was copied from the block notification for further analysis using VirusTotal.

#### **Results:**
NetCraft successfully blocked the connection to the malicious link and displayed a warning.

#### **Interpretation:**  
NetCraft provides additional protection by detecting and automatically blocking malicious links before harm can occur.

---

### **3. Analysis of the Phishing Link with VirusTotal**

#### **Steps:**
1. **Analyzing with VirusTotal**:
   - The previously blocked link `https://end-authenticat.tftpd.net/` was submitted to VirusTotal.
   - The results showed that **11 out of 96 security vendors** flagged the link as malicious.  
   - ![VirusTotal Result Screenshot](Virus%20total%20ergebnis.png)

2. **Interpreting the Results**:
   - Classifications such as **Phishing** and **Malicious** were repeatedly identified.
   - The results confirm that the link posed a real threat.

#### **Results:**  
VirusTotal identified the link as dangerous and validated the functionality of the NetCraft extension.

---

### **4. Identification of the Linkâ€™s IP Address**

#### **Steps:**
1. **Extracting the IP Address**:
   - The VirusTotal report revealed the associated IP address of the link: `104.26.7.95`.

2. **Using the IP Address**:
   - The IP address was recorded for later creation of a specific firewall rule.

#### **Results:**  
The IP address was successfully extracted and prepared for blocking.

---

### **5. Blocking the Link Using Microsoft Defender Firewall**

#### **Steps:**
1. **Opening the Advanced Firewall Settings**:
   - The Windows Defender Firewall with Advanced Security was opened.

2. **Creating a New Outbound Rule**:
   - A custom rule was created to block the IP address `104.26.7.95`.
   - Steps in detail:
     - **Rule Type**: Custom.
     - **Program**: All programs or specific executable paths (e.g., `firefox.exe`).
     - **Protocol**: TCP.
     - **IP Address**: The IP to block was entered under "These IP addresses".
     - **Action**: Block the connection.
     - **Profile**: Enabled for all profiles.
     - **Rule Name**: "Block Malicious Link - end-authenticat".

3. **Testing the Rule**:
   - The link was re-accessed, and the connection was successfully blocked.

#### **Results:**  
The firewall rule blocked the connection to the IP address, preventing access to the malicious site.

#### **Interpretation:**  
Microsoft Defender Firewall proved to be an effective tool for blocking specific threats through IP-based rules.

---

## **Summary**

### **Steps Taken:**
1. Creation of a realistic phishing email and sending it to a temporary email address.  
2. Checking the malicious link with NetCraft.  
3. Analysis of the link using VirusTotal.  
4. Identification and blocking of the associated IP address using Microsoft Defender Firewall.

### **Findings:**
- Phishing emails can be easily created and made highly convincing.
- NetCraft and VirusTotal are reliable tools for identifying threats.
- Microsoft Defender Firewall allows targeted blocking of malicious IP addresses.

### **Recommendations:**
- Organizations should conduct regular training on phishing awareness.
- Security tools like NetCraft, VirusTotal, and Microsoft Defender should be actively incorporated into defense strategies.
- Specific rules for malicious links and IP addresses should be regularly reviewed and updated.

---